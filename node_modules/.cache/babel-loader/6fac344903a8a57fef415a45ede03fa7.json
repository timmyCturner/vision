{"ast":null,"code":"let smogClouds = [];\nlet originalData = null;\nconst initial_clouds = 4;\nlet extra_clouds = 0;\nexport let hoveredSmogData = {\n  mouseOver: false,\n  value: null\n};\nlet hoveredSmog = null;\n\nclass SmogCloud {\n  constructor(p) {\n    this.todayData = null;\n    this.xVelocity = p.random(-2, 2); //cloud movement velocity\n\n    this.x = p.random(50, p.width);\n    this.y = p.random(50, 200);\n    this.width = p.random(100, 300);\n    this.height = p.random(50, 100);\n    this.smogBubbles = [];\n    this.opacity = p.random(50, 200);\n    this.addlimit = 0;\n\n    for (let x = 0; x < 25; x++) {\n      this.smogBubbles[x] = new SmogBubble(p, this.width, this.height);\n    }\n\n    this.display = function (todayData) {\n      this.oldData = this.todayData;\n      this.todayData = todayData;\n\n      if (this.todayData == undefined) {\n        this.todayData = this.oldData;\n      } // console.log(\"Displaying smog cloud\");\n\n\n      if (this.oldData != undefined) {\n        p.noStroke();\n        let cloudColor = p.color(100);\n        cloudColor.setAlpha(this.opacity);\n        p.fill(cloudColor);\n        this.width += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n        this.height += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n        p.ellipse(this.x, this.y, this.width, this.height);\n        p.beginShape();\n\n        for (let x = 0; x < this.smogBubbles.length; x++) {\n          cloudColor.setAlpha(this.smogBubbles[x].opacity);\n          p.fill(cloudColor);\n          this.smogBubbles[x].rx += (this.todayData.average - this.oldData.average) * 10;\n          this.smogBubbles[x].ry += (this.todayData.average - this.oldData.average) * 10; //this.smogBubbles[x].rxVelocity += (this.todayData.average - this.oldData.average)\n          //this.smogBubbles[x].ryVelocity += (this.todayData.average - this.oldData.average)\n\n          this.smogBubbles[x].display(this.x, this.y);\n        }\n      }\n\n      p.endShape(p.CLOSE);\n    };\n\n    this.move = function () {\n      if (this.oldData != undefined) {\n        this.addlimit += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n\n        for (let x = 0; x < this.smogBubbles.length; x++) {\n          if (Math.abs(this.smogBubbles[x].xOffset) > this.width / 2 - 10 + this.addLimit) {\n            this.smogBubbles[x].xVelocity *= -1;\n          }\n\n          if (Math.abs(this.smogBubbles[x].yOffset) > this.height / 2 - 10 + this.addLimit) {\n            this.smogBubbles[x].yVelocity *= -1;\n          }\n\n          if (this.smogBubbles[x].rx < 70 + this.addlimit || this.smogBubbles[x].rx > 150 + this.addlimit) {\n            this.smogBubbles[x].rxVelocity *= -1;\n          }\n\n          if (this.smogBubbles[x].ry < 70 + this.addlimit || this.smogBubbles[x].ry > 150 + this.addlimit) {\n            this.smogBubbles[x].ryVelocity *= -1;\n          }\n\n          this.smogBubbles[x].xOffset += this.smogBubbles[x].xVelocity;\n          this.smogBubbles[x].yOffset += this.smogBubbles[x].yVelocity;\n          this.smogBubbles[x].rx += this.smogBubbles[x].rxVelocity;\n          this.smogBubbles[x].ry += this.smogBubbles[x].ryVelocity;\n          this.smogBubbles[x].move();\n        }\n      }\n\n      if (this.x > p.width + 50) {\n        this.x = -50;\n      } else if (this.x < -50) {\n        this.x = p.width - 100;\n      }\n\n      this.x += this.xVelocity;\n    };\n  }\n\n}\n\nclass SmogBubble {\n  constructor(p, xlimit, ylimit) {\n    this.opacity = p.random(50, 200);\n    this.xVelocity = p.random(0.03, 0.07);\n    this.yVelocity = p.random(0.03, 0.07);\n    this.xOffset = p.random(xlimit / 2 * -1, xlimit / 2);\n    this.yOffset = p.random(ylimit / 2 * -1, ylimit / 2);\n    this.rx = p.random(70, 150);\n    this.ry = p.random(70, 150);\n    this.rxVelocity = p.random(0.1, 0.5);\n    this.ryVelocity = p.random(0.1, 0.5);\n\n    this.display = function (x, y) {\n      p.ellipse(x + this.xOffset, y + this.yOffset, this.rx, this.ry);\n      p.curveVertex(x + this.xOffset, y + this.yOffset);\n    };\n\n    this.move = function () {\n      // check if mouse is pressed and within range of bubble\n      if (p.mouseIsPressed && p.dist(p.mouseX, p.mouseY, this.x, this.y) < this.size) {\n        hoveredSmogData.mouseOver = true;\n        hoveredSmog = this;\n      }\n    };\n  }\n\n}\n\nexport function setupSmogClouds(p, nitrousData, currentDate) {\n  for (let i = 0; i < initial_clouds; i++) {\n    smogClouds[i] = new SmogCloud(p, nitrousData, currentDate);\n  }\n}\nexport function drawSmogClouds(p, nitrousData, currentDate) {\n  let currIndex = 33 + (currentDate.getFullYear() - 2004) * 12 + currentDate.getMonth();\n\n  if (originalData == null && nitrousData != null) {\n    originalData = nitrousData[0];\n  } else if (nitrousData != undefined && currIndex > 0 && currIndex < nitrousData.length) {\n    let diff = Math.round((nitrousData[currIndex].average - originalData.average) / 10) - extra_clouds; //console.log(diff);\n\n    if (diff > 0) {\n      for (let x = 0; x < diff; x++) {\n        smogClouds[smogClouds.length] = new SmogCloud(p, nitrousData, currentDate);\n        extra_clouds++;\n      }\n    } else if (diff < 0) {\n      let slice = smogClouds.length - 1 + diff;\n      extra_clouds -= smogClouds.length - 1 - slice;\n      smogClouds = smogClouds.slice(0, slice);\n    }\n  }\n\n  if (currIndex >= 0) {\n    hoveredSmogData.value = nitrousData[currIndex];\n\n    for (var i = 0; i < smogClouds.length; i++) {\n      if (!hoveredSmogData.mouseOver) {\n        smogClouds[i].move(p);\n      } else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\n        hoveredSmogData.mouseOver = false;\n      }\n\n      smogClouds[i].display(nitrousData[currIndex]);\n    }\n  } else {\n    hoveredSmogData.value = nitrousData[0];\n\n    for (var i = 0; i < smogClouds.length; i++) {\n      if (!hoveredSmogData.mouseOver) {\n        smogClouds[i].move(p);\n      } else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\n        hoveredSmogData.mouseOver = false;\n      }\n\n      smogClouds[i].display(nitrousData[0]);\n    }\n  }\n} //nitrousData[;","map":{"version":3,"sources":["C:/Users/kuent/Documents/FinishDipshit/Creative/Ocean-Weather-Visualization/src/sketches/smogClouds.js"],"names":["smogClouds","originalData","initial_clouds","extra_clouds","hoveredSmogData","mouseOver","value","hoveredSmog","SmogCloud","constructor","p","todayData","xVelocity","random","x","width","y","height","smogBubbles","opacity","addlimit","SmogBubble","display","oldData","undefined","noStroke","cloudColor","color","setAlpha","fill","parseFloat","average","ellipse","beginShape","length","rx","ry","endShape","CLOSE","move","Math","abs","xOffset","addLimit","yOffset","yVelocity","rxVelocity","ryVelocity","xlimit","ylimit","curveVertex","mouseIsPressed","dist","mouseX","mouseY","size","setupSmogClouds","nitrousData","currentDate","i","drawSmogClouds","currIndex","getFullYear","getMonth","diff","round","slice"],"mappings":"AAAA,IAAIA,UAAU,GAAG,EAAjB;AACA,IAAIC,YAAY,GAAG,IAAnB;AACA,MAAMC,cAAc,GAAG,CAAvB;AACA,IAAIC,YAAY,GAAG,CAAnB;AAEA,OAAO,IAAIC,eAAe,GAAG;AAAEC,EAAAA,SAAS,EAAE,KAAb;AAAoBC,EAAAA,KAAK,EAAE;AAA3B,CAAtB;AACP,IAAIC,WAAW,GAAG,IAAlB;;AAEA,MAAMC,SAAN,CAAgB;AACZC,EAAAA,WAAW,CAACC,CAAD,EAAI;AACX,SAAKC,SAAL,GAAiB,IAAjB;AAEA,SAAKC,SAAL,GAAiBF,CAAC,CAACG,MAAF,CAAS,CAAC,CAAV,EAAa,CAAb,CAAjB,CAHW,CAGuB;;AAClC,SAAKC,CAAL,GAASJ,CAAC,CAACG,MAAF,CAAS,EAAT,EAAaH,CAAC,CAACK,KAAf,CAAT;AACA,SAAKC,CAAL,GAASN,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAT;AACA,SAAKE,KAAL,GAAaL,CAAC,CAACG,MAAF,CAAS,GAAT,EAAc,GAAd,CAAb;AACA,SAAKI,MAAL,GAAcP,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAd;AACA,SAAKK,WAAL,GAAmB,EAAnB;AACA,SAAKC,OAAL,GAAeT,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAf;AACA,SAAKO,QAAL,GAAgB,CAAhB;;AAEA,SAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AACzB,WAAKI,WAAL,CAAiBJ,CAAjB,IAAsB,IAAIO,UAAJ,CAAeX,CAAf,EAAkB,KAAKK,KAAvB,EAA8B,KAAKE,MAAnC,CAAtB;AACH;;AAED,SAAKK,OAAL,GAAe,UAAUX,SAAV,EAAqB;AAChC,WAAKY,OAAL,GAAe,KAAKZ,SAApB;AACA,WAAKA,SAAL,GAAiBA,SAAjB;;AACA,UAAG,KAAKA,SAAL,IAAkBa,SAArB,EAAgC;AAC5B,aAAKb,SAAL,GAAiB,KAAKY,OAAtB;AACH,OAL+B,CAMhC;;;AAEA,UAAG,KAAKA,OAAL,IAAgBC,SAAnB,EAA8B;AAC1Bd,QAAAA,CAAC,CAACe,QAAF;AACA,YAAIC,UAAU,GAAGhB,CAAC,CAACiB,KAAF,CAAQ,GAAR,CAAjB;AACAD,QAAAA,UAAU,CAACE,QAAX,CAAoB,KAAKT,OAAzB;AACAT,QAAAA,CAAC,CAACmB,IAAF,CAAOH,UAAP;AAEA,aAAKX,KAAL,IAAc,CAACe,UAAU,CAAC,KAAKnB,SAAL,CAAeoB,OAAhB,CAAV,GAAqCD,UAAU,CAAC,KAAKP,OAAL,CAAaQ,OAAd,CAAhD,IAAyE,EAAvF;AACA,aAAKd,MAAL,IAAe,CAACa,UAAU,CAAC,KAAKnB,SAAL,CAAeoB,OAAhB,CAAV,GAAqCD,UAAU,CAAC,KAAKP,OAAL,CAAaQ,OAAd,CAAhD,IAAyE,EAAxF;AAEArB,QAAAA,CAAC,CAACsB,OAAF,CAAU,KAAKlB,CAAf,EAAkB,KAAKE,CAAvB,EAA0B,KAAKD,KAA/B,EAAsC,KAAKE,MAA3C;AACAP,QAAAA,CAAC,CAACuB,UAAF;;AACA,aAAK,IAAInB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKI,WAAL,CAAiBgB,MAArC,EAA6CpB,CAAC,EAA9C,EAAkD;AAC9CY,UAAAA,UAAU,CAACE,QAAX,CAAoB,KAAKV,WAAL,CAAiBJ,CAAjB,EAAoBK,OAAxC;AACAT,UAAAA,CAAC,CAACmB,IAAF,CAAOH,UAAP;AACA,eAAKR,WAAL,CAAiBJ,CAAjB,EAAoBqB,EAApB,IAA0B,CAAC,KAAKxB,SAAL,CAAeoB,OAAf,GAAyB,KAAKR,OAAL,CAAaQ,OAAvC,IAAiD,EAA3E;AACA,eAAKb,WAAL,CAAiBJ,CAAjB,EAAoBsB,EAApB,IAA0B,CAAC,KAAKzB,SAAL,CAAeoB,OAAf,GAAyB,KAAKR,OAAL,CAAaQ,OAAvC,IAAiD,EAA3E,CAJ8C,CAM9C;AACA;;AAEA,eAAKb,WAAL,CAAiBJ,CAAjB,EAAoBQ,OAApB,CAA4B,KAAKR,CAAjC,EAAmC,KAAKE,CAAxC;AACH;AACJ;;AACDN,MAAAA,CAAC,CAAC2B,QAAF,CAAW3B,CAAC,CAAC4B,KAAb;AACH,KAhCD;;AAkCA,SAAKC,IAAL,GAAY,YAAY;AACpB,UAAG,KAAKhB,OAAL,IAAgBC,SAAnB,EAA8B;AAC1B,aAAKJ,QAAL,IAAiB,CAACU,UAAU,CAAC,KAAKnB,SAAL,CAAeoB,OAAhB,CAAV,GAAqCD,UAAU,CAAC,KAAKP,OAAL,CAAaQ,OAAd,CAAhD,IAAyE,EAA1F;;AACA,aAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKI,WAAL,CAAiBgB,MAArC,EAA6CpB,CAAC,EAA9C,EAAkD;AAC9C,cAAI0B,IAAI,CAACC,GAAL,CAAS,KAAKvB,WAAL,CAAiBJ,CAAjB,EAAoB4B,OAA7B,IAAwC,KAAK3B,KAAL,GAAa,CAAb,GAAiB,EAAjB,GAAsB,KAAK4B,QAAvE,EAAiF;AAC7E,iBAAKzB,WAAL,CAAiBJ,CAAjB,EAAoBF,SAApB,IAAiC,CAAC,CAAlC;AACH;;AACD,cAAI4B,IAAI,CAACC,GAAL,CAAS,KAAKvB,WAAL,CAAiBJ,CAAjB,EAAoB8B,OAA7B,IAAwC,KAAK3B,MAAL,GAAc,CAAd,GAAkB,EAAlB,GAAuB,KAAK0B,QAAxE,EAAkF;AAC9E,iBAAKzB,WAAL,CAAiBJ,CAAjB,EAAoB+B,SAApB,IAAiC,CAAC,CAAlC;AACH;;AACD,cAAI,KAAK3B,WAAL,CAAiBJ,CAAjB,EAAoBqB,EAApB,GAAyB,KAAK,KAAKf,QAAnC,IAA+C,KAAKF,WAAL,CAAiBJ,CAAjB,EAAoBqB,EAApB,GAAyB,MAAM,KAAKf,QAAvF,EAAiG;AAC7F,iBAAKF,WAAL,CAAiBJ,CAAjB,EAAoBgC,UAApB,IAAkC,CAAC,CAAnC;AACH;;AACD,cAAI,KAAK5B,WAAL,CAAiBJ,CAAjB,EAAoBsB,EAApB,GAAyB,KAAK,KAAKhB,QAAnC,IAA+C,KAAKF,WAAL,CAAiBJ,CAAjB,EAAoBsB,EAApB,GAAyB,MAAM,KAAKhB,QAAvF,EAAiG;AAC7F,iBAAKF,WAAL,CAAiBJ,CAAjB,EAAoBiC,UAApB,IAAkC,CAAC,CAAnC;AACH;;AAED,eAAK7B,WAAL,CAAiBJ,CAAjB,EAAoB4B,OAApB,IAA+B,KAAKxB,WAAL,CAAiBJ,CAAjB,EAAoBF,SAAnD;AACA,eAAKM,WAAL,CAAiBJ,CAAjB,EAAoB8B,OAApB,IAA+B,KAAK1B,WAAL,CAAiBJ,CAAjB,EAAoB+B,SAAnD;AAEA,eAAK3B,WAAL,CAAiBJ,CAAjB,EAAoBqB,EAApB,IAA0B,KAAKjB,WAAL,CAAiBJ,CAAjB,EAAoBgC,UAA9C;AACA,eAAK5B,WAAL,CAAiBJ,CAAjB,EAAoBsB,EAApB,IAA0B,KAAKlB,WAAL,CAAiBJ,CAAjB,EAAoBiC,UAA9C;AAEA,eAAK7B,WAAL,CAAiBJ,CAAjB,EAAoByB,IAApB;AACH;AACJ;;AACD,UAAI,KAAKzB,CAAL,GAASJ,CAAC,CAACK,KAAF,GAAU,EAAvB,EAA2B;AACvB,aAAKD,CAAL,GAAS,CAAC,EAAV;AACH,OAFD,MAEO,IAAI,KAAKA,CAAL,GAAS,CAAC,EAAd,EAAkB;AACrB,aAAKA,CAAL,GAASJ,CAAC,CAACK,KAAF,GAAU,GAAnB;AACH;;AACD,WAAKD,CAAL,IAAU,KAAKF,SAAf;AACH,KAhCD;AAiCH;;AApFW;;AAuFhB,MAAMS,UAAN,CAAiB;AACbZ,EAAAA,WAAW,CAACC,CAAD,EAAIsC,MAAJ,EAAYC,MAAZ,EAAoB;AAC3B,SAAK9B,OAAL,GAAeT,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAf;AACA,SAAKD,SAAL,GAAiBF,CAAC,CAACG,MAAF,CAAS,IAAT,EAAe,IAAf,CAAjB;AACA,SAAKgC,SAAL,GAAiBnC,CAAC,CAACG,MAAF,CAAS,IAAT,EAAe,IAAf,CAAjB;AACA,SAAK6B,OAAL,GAAehC,CAAC,CAACG,MAAF,CAAUmC,MAAM,GAAG,CAAV,GAAe,CAAC,CAAzB,EAA4BA,MAAM,GAAG,CAArC,CAAf;AACA,SAAKJ,OAAL,GAAelC,CAAC,CAACG,MAAF,CAAUoC,MAAM,GAAG,CAAV,GAAe,CAAC,CAAzB,EAA4BA,MAAM,GAAG,CAArC,CAAf;AACA,SAAKd,EAAL,GAAUzB,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAV;AACA,SAAKuB,EAAL,GAAU1B,CAAC,CAACG,MAAF,CAAS,EAAT,EAAa,GAAb,CAAV;AAEA,SAAKiC,UAAL,GAAkBpC,CAAC,CAACG,MAAF,CAAS,GAAT,EAAc,GAAd,CAAlB;AACA,SAAKkC,UAAL,GAAkBrC,CAAC,CAACG,MAAF,CAAS,GAAT,EAAc,GAAd,CAAlB;;AAEJ,SAAKS,OAAL,GAAe,UAAUR,CAAV,EAAYE,CAAZ,EAAe;AAC5BN,MAAAA,CAAC,CAACsB,OAAF,CACIlB,CAAC,GAAG,KAAK4B,OADb,EAEI1B,CAAC,GAAG,KAAK4B,OAFb,EAGI,KAAKT,EAHT,EAII,KAAKC,EAJT;AAMA1B,MAAAA,CAAC,CAACwC,WAAF,CACIpC,CAAC,GAAG,KAAK4B,OADb,EAEI1B,CAAC,GAAG,KAAK4B,OAFb;AAID,KAXD;;AAYA,SAAKL,IAAL,GAAY,YAAU;AAAC;AAErB,UAAI7B,CAAC,CAACyC,cAAF,IAAoBzC,CAAC,CAAC0C,IAAF,CAAO1C,CAAC,CAAC2C,MAAT,EAAiB3C,CAAC,CAAC4C,MAAnB,EAA2B,KAAKxC,CAAhC,EAAmC,KAAKE,CAAxC,IAA6C,KAAKuC,IAA1E,EAAgF;AAC5EnD,QAAAA,eAAe,CAACC,SAAhB,GAA4B,IAA5B;AACAE,QAAAA,WAAW,GAAG,IAAd;AAEH;AACF,KAPD;AAQD;;AAjCc;;AAoCjB,OAAO,SAASiD,eAAT,CAAyB9C,CAAzB,EAA4B+C,WAA5B,EAAyCC,WAAzC,EAAsD;AACzD,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGzD,cAApB,EAAoCyD,CAAC,EAArC,EAAyC;AACrC3D,IAAAA,UAAU,CAAC2D,CAAD,CAAV,GAAgB,IAAInD,SAAJ,CAAcE,CAAd,EAAiB+C,WAAjB,EAA8BC,WAA9B,CAAhB;AACH;AAEJ;AAED,OAAO,SAASE,cAAT,CAAwBlD,CAAxB,EAA2B+C,WAA3B,EAAwCC,WAAxC,EAAqD;AACpD,MAAIG,SAAS,GAAG,KAAM,CAACH,WAAW,CAACI,WAAZ,KAA4B,IAA7B,IAAqC,EAA3C,GAAiDJ,WAAW,CAACK,QAAZ,EAAjE;;AAEA,MAAG9D,YAAY,IAAI,IAAhB,IAAwBwD,WAAW,IAAI,IAA1C,EAAgD;AAC5CxD,IAAAA,YAAY,GAAGwD,WAAW,CAAC,CAAD,CAA1B;AACH,GAFD,MAGK,IAAGA,WAAW,IAAIjC,SAAf,IAA4BqC,SAAS,GAAG,CAAxC,IAA6CA,SAAS,GAAGJ,WAAW,CAACvB,MAAxE,EAAgF;AACjF,QAAI8B,IAAI,GAAGxB,IAAI,CAACyB,KAAL,CAAY,CAACR,WAAW,CAACI,SAAD,CAAX,CAAuB9B,OAAvB,GAAiC9B,YAAY,CAAC8B,OAA/C,IAAwD,EAApE,IAA2E5B,YAAtF,CADiF,CAEjF;;AAEA,QAAG6D,IAAI,GAAG,CAAV,EAAa;AACT,WAAI,IAAIlD,CAAC,GAAG,CAAZ,EAAgBA,CAAC,GAAGkD,IAApB,EAA0BlD,CAAC,EAA3B,EAA+B;AAC3Bd,QAAAA,UAAU,CAACA,UAAU,CAACkC,MAAZ,CAAV,GAAgC,IAAI1B,SAAJ,CAAcE,CAAd,EAAiB+C,WAAjB,EAA8BC,WAA9B,CAAhC;AACAvD,QAAAA,YAAY;AACf;AACJ,KALD,MAMK,IAAG6D,IAAI,GAAG,CAAV,EAAa;AACd,UAAIE,KAAK,GAAGlE,UAAU,CAACkC,MAAX,GAAoB,CAApB,GAAwB8B,IAApC;AACA7D,MAAAA,YAAY,IAAIH,UAAU,CAACkC,MAAX,GAAoB,CAApB,GAAwBgC,KAAxC;AACAlE,MAAAA,UAAU,GAAGA,UAAU,CAACkE,KAAX,CAAiB,CAAjB,EAAoBA,KAApB,CAAb;AACH;AACJ;;AAED,MAAGL,SAAS,IAAI,CAAhB,EAAmB;AACfzD,IAAAA,eAAe,CAACE,KAAhB,GAAwBmD,WAAW,CAACI,SAAD,CAAnC;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG3D,UAAU,CAACkC,MAA/B,EAAuCyB,CAAC,EAAxC,EAA4C;AAC1C,UAAI,CAACvD,eAAe,CAACC,SAArB,EAAgC;AAE9BL,QAAAA,UAAU,CAAC2D,CAAD,CAAV,CAAcpB,IAAd,CAAmB7B,CAAnB;AACD,OAHD,MAIK,IAAIA,CAAC,CAAC0C,IAAF,CAAO1C,CAAC,CAAC2C,MAAT,EAAiB3C,CAAC,CAAC4C,MAAnB,EAA2B/C,WAAW,CAACO,CAAvC,EAA0CP,WAAW,CAACS,CAAtD,IAA2DT,WAAW,CAACgD,IAA3E,EAAiF;AAClFnD,QAAAA,eAAe,CAACC,SAAhB,GAA4B,KAA5B;AACH;;AAECL,MAAAA,UAAU,CAAC2D,CAAD,CAAV,CAAcrC,OAAd,CAAsBmC,WAAW,CAACI,SAAD,CAAjC;AACH;AACJ,GAbD,MAcK;AACDzD,IAAAA,eAAe,CAACE,KAAhB,GAAwBmD,WAAW,CAAC,CAAD,CAAnC;;AACA,SAAI,IAAIE,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG3D,UAAU,CAACkC,MAA9B,EAAsCyB,CAAC,EAAvC,EAA2C;AACzC,UAAI,CAACvD,eAAe,CAACC,SAArB,EAAgC;AAE9BL,QAAAA,UAAU,CAAC2D,CAAD,CAAV,CAAcpB,IAAd,CAAmB7B,CAAnB;AACD,OAHD,MAIK,IAAIA,CAAC,CAAC0C,IAAF,CAAO1C,CAAC,CAAC2C,MAAT,EAAiB3C,CAAC,CAAC4C,MAAnB,EAA2B/C,WAAW,CAACO,CAAvC,EAA0CP,WAAW,CAACS,CAAtD,IAA2DT,WAAW,CAACgD,IAA3E,EAAiF;AAClFnD,QAAAA,eAAe,CAACC,SAAhB,GAA4B,KAA5B;AACH;;AAECL,MAAAA,UAAU,CAAC2D,CAAD,CAAV,CAAcrC,OAAd,CAAsBmC,WAAW,CAAC,CAAD,CAAjC;AACH;AACJ;AAGR,C,CAED","sourcesContent":["let smogClouds = [];\r\nlet originalData = null;\r\nconst initial_clouds = 4;\r\nlet extra_clouds = 0;\r\n\r\nexport let hoveredSmogData = { mouseOver: false, value: null };\r\nlet hoveredSmog = null;\r\n\r\nclass SmogCloud {\r\n    constructor(p) {\r\n        this.todayData = null;\r\n\r\n        this.xVelocity = p.random(-2, 2); //cloud movement velocity\r\n        this.x = p.random(50, p.width);\r\n        this.y = p.random(50, 200);\r\n        this.width = p.random(100, 300);\r\n        this.height = p.random(50, 100);\r\n        this.smogBubbles = [];\r\n        this.opacity = p.random(50, 200);\r\n        this.addlimit = 0;\r\n\r\n        for (let x = 0; x < 25; x++) {\r\n            this.smogBubbles[x] = new SmogBubble(p, this.width, this.height);\r\n        }\r\n\r\n        this.display = function (todayData) {\r\n            this.oldData = this.todayData\r\n            this.todayData = todayData;\r\n            if(this.todayData == undefined) {\r\n                this.todayData = this.oldData;\r\n            }\r\n            // console.log(\"Displaying smog cloud\");\r\n\r\n            if(this.oldData != undefined) {\r\n                p.noStroke();\r\n                let cloudColor = p.color(100);\r\n                cloudColor.setAlpha(this.opacity);\r\n                p.fill(cloudColor);\r\n\r\n                this.width += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10\r\n                this.height += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10\r\n\r\n                p.ellipse(this.x, this.y, this.width, this.height);\r\n                p.beginShape();\r\n                for (let x = 0; x < this.smogBubbles.length; x++) {\r\n                    cloudColor.setAlpha(this.smogBubbles[x].opacity);\r\n                    p.fill(cloudColor);\r\n                    this.smogBubbles[x].rx += (this.todayData.average - this.oldData.average)* 10\r\n                    this.smogBubbles[x].ry += (this.todayData.average - this.oldData.average)* 10\r\n\r\n                    //this.smogBubbles[x].rxVelocity += (this.todayData.average - this.oldData.average)\r\n                    //this.smogBubbles[x].ryVelocity += (this.todayData.average - this.oldData.average)\r\n\r\n                    this.smogBubbles[x].display(this.x,this.y)\r\n                }\r\n            }\r\n            p.endShape(p.CLOSE);\r\n        };\r\n\r\n        this.move = function () {\r\n            if(this.oldData != undefined) {\r\n                this.addlimit += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10;\r\n                for (let x = 0; x < this.smogBubbles.length; x++) {\r\n                    if (Math.abs(this.smogBubbles[x].xOffset) > this.width / 2 - 10 + this.addLimit) {\r\n                        this.smogBubbles[x].xVelocity *= -1;\r\n                    }\r\n                    if (Math.abs(this.smogBubbles[x].yOffset) > this.height / 2 - 10 + this.addLimit) {\r\n                        this.smogBubbles[x].yVelocity *= -1;\r\n                    }\r\n                    if (this.smogBubbles[x].rx < 70 + this.addlimit || this.smogBubbles[x].rx > 150 + this.addlimit) {\r\n                        this.smogBubbles[x].rxVelocity *= -1;\r\n                    }\r\n                    if (this.smogBubbles[x].ry < 70 + this.addlimit || this.smogBubbles[x].ry > 150 + this.addlimit) {\r\n                        this.smogBubbles[x].ryVelocity *= -1;\r\n                    }\r\n\r\n                    this.smogBubbles[x].xOffset += this.smogBubbles[x].xVelocity;\r\n                    this.smogBubbles[x].yOffset += this.smogBubbles[x].yVelocity;\r\n\r\n                    this.smogBubbles[x].rx += this.smogBubbles[x].rxVelocity;\r\n                    this.smogBubbles[x].ry += this.smogBubbles[x].ryVelocity;\r\n\r\n                    this.smogBubbles[x].move()\r\n                }\r\n            }\r\n            if (this.x > p.width + 50) {\r\n                this.x = -50;\r\n            } else if (this.x < -50) {\r\n                this.x = p.width - 100;\r\n            }\r\n            this.x += this.xVelocity;\r\n        };\r\n    }\r\n}\r\n\r\nclass SmogBubble {\r\n    constructor(p, xlimit, ylimit) {\r\n        this.opacity = p.random(50, 200);\r\n        this.xVelocity = p.random(0.03, 0.07);\r\n        this.yVelocity = p.random(0.03, 0.07);\r\n        this.xOffset = p.random((xlimit / 2) * -1, xlimit / 2);\r\n        this.yOffset = p.random((ylimit / 2) * -1, ylimit / 2);\r\n        this.rx = p.random(70, 150);\r\n        this.ry = p.random(70, 150);\r\n\r\n        this.rxVelocity = p.random(0.1, 0.5);\r\n        this.ryVelocity = p.random(0.1, 0.5);\r\n\r\n    this.display = function (x,y) {\r\n      p.ellipse(\r\n          x + this.xOffset,\r\n          y + this.yOffset,\r\n          this.rx,\r\n          this.ry\r\n      );\r\n      p.curveVertex(\r\n          x + this.xOffset,\r\n          y + this.yOffset\r\n      );\r\n    }\r\n    this.move = function(){// check if mouse is pressed and within range of bubble\r\n\r\n      if (p.mouseIsPressed && p.dist(p.mouseX, p.mouseY, this.x, this.y) < this.size) {\r\n          hoveredSmogData.mouseOver = true;\r\n          hoveredSmog = this;\r\n\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function setupSmogClouds(p, nitrousData, currentDate) {\r\n    for (let i = 0; i < initial_clouds; i++) {\r\n        smogClouds[i] = new SmogCloud(p, nitrousData, currentDate);\r\n    }\r\n\r\n}\r\n\r\nexport function drawSmogClouds(p, nitrousData, currentDate) {\r\n        let currIndex = 33 + ((currentDate.getFullYear() - 2004) * 12) + currentDate.getMonth()\r\n\r\n        if(originalData == null && nitrousData != null) {\r\n            originalData = nitrousData[0];\r\n        }\r\n        else if(nitrousData != undefined && currIndex > 0 && currIndex < nitrousData.length) {\r\n            let diff = Math.round(((nitrousData[currIndex].average - originalData.average)/10)) - extra_clouds;\r\n            //console.log(diff);\r\n\r\n            if(diff > 0) {\r\n                for(let x = 0 ; x < diff; x++) {\r\n                    smogClouds[smogClouds.length] = new SmogCloud(p, nitrousData, currentDate);\r\n                    extra_clouds++;\r\n                }\r\n            }\r\n            else if(diff < 0) {\r\n                let slice = smogClouds.length - 1 + diff;\r\n                extra_clouds -= smogClouds.length - 1 - slice;\r\n                smogClouds = smogClouds.slice(0, slice);\r\n            }\r\n        }\r\n\r\n        if(currIndex >= 0) {\r\n            hoveredSmogData.value = nitrousData[currIndex]\r\n            for (var i = 0; i < smogClouds.length; i++) {\r\n              if (!hoveredSmogData.mouseOver) {\r\n\r\n                smogClouds[i].move(p);\r\n              }\r\n              else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\r\n                  hoveredSmogData.mouseOver = false;\r\n              }\r\n\r\n                smogClouds[i].display(nitrousData[currIndex]);\r\n            }\r\n        }\r\n        else {\r\n            hoveredSmogData.value = nitrousData[0]\r\n            for(var i = 0; i < smogClouds.length; i++) {\r\n              if (!hoveredSmogData.mouseOver) {\r\n\r\n                smogClouds[i].move(p);\r\n              }\r\n              else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\r\n                  hoveredSmogData.mouseOver = false;\r\n              }\r\n\r\n                smogClouds[i].display(nitrousData[0]);\r\n            }\r\n        }\r\n\r\n\r\n}\r\n\r\n//nitrousData[;\r\n"]},"metadata":{},"sourceType":"module"}