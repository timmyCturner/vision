{"ast":null,"code":"let smogClouds = [];\nlet originalData = null;\nconst initial_clouds = 4;\nlet extra_clouds = 0;\nexport let hoveredSmogData = {\n  mouseOver: false,\n  value: null\n};\nlet hoveredSmog = null;\n\nclass SmogCloud {\n  constructor(p, todayData, initial) {\n    let diff = 0;\n\n    if (todayData == undefined || initial == undefined) {\n      this.todayData = undefined;\n      this.oldData = undefined;\n    } else {\n      this.todayData = todayData;\n      this.oldData = initial;\n      diff = Math.round((todayData.average - initial.average) * 10);\n    }\n\n    this.xVelocity = p.random(-2, 2); //cloud movement velocity\n\n    this.x = p.random(50, p.width);\n    this.y = p.random(50, 200);\n    this.width = p.random(100 + diff, 300 + diff);\n    this.height = p.random(50 + diff, 100 + diff);\n    this.smogBubbles = [];\n    this.opacity = p.random(50, 200);\n    this.addlimit = 0;\n\n    for (let x = 0; x < 25; x++) {\n      this.smogBubbles[x] = new SmogBubble(p, this.width, this.height, diff, diff);\n    }\n\n    this.display = function (todayData) {\n      this.oldData = this.todayData;\n      this.todayData = todayData;\n\n      if (this.todayData == undefined) {\n        this.todayData = this.oldData;\n      } // console.log(\"Displaying smog cloud\");\n\n\n      if (this.oldData != undefined) {\n        p.noStroke();\n        let cloudColor = p.color(100);\n        cloudColor.setAlpha(this.opacity);\n        p.fill(cloudColor);\n        this.width += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n        this.height += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n\n        if (hoveredSmogData.mouseOver) {\n          p.fill(225, 225, 0, 70);\n        }\n\n        p.ellipse(this.x, this.y, this.width, this.height);\n        p.beginShape();\n\n        for (let x = 0; x < this.smogBubbles.length; x++) {\n          cloudColor.setAlpha(this.smogBubbles[x].opacity);\n          p.fill(cloudColor);\n          this.smogBubbles[x].rx += (this.todayData.average - this.oldData.average) * 10;\n          this.smogBubbles[x].ry += (this.todayData.average - this.oldData.average) * 10; //this.smogBubbles[x].rxVelocity += (this.todayData.average - this.oldData.average)\n          //this.smogBubbles[x].ryVelocity += (this.todayData.average - this.oldData.average)\n\n          if (hoveredSmogData.mouseOver) {\n            p.fill(225, 225, 0, 70);\n          }\n\n          this.smogBubbles[x].display(this.x, this.y);\n        }\n      }\n\n      p.endShape(p.CLOSE);\n    };\n\n    this.move = function () {\n      if (this.oldData != undefined) {\n        this.addlimit += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average)) * 10;\n\n        for (let x = 0; x < this.smogBubbles.length; x++) {\n          if (Math.abs(this.smogBubbles[x].xOffset) > this.width / 2 - 10 + this.addLimit) {\n            this.smogBubbles[x].xVelocity *= -1;\n          }\n\n          if (Math.abs(this.smogBubbles[x].yOffset) > this.height / 2 - 10 + this.addLimit) {\n            this.smogBubbles[x].yVelocity *= -1;\n          }\n\n          if (this.smogBubbles[x].rx < 70 + this.addlimit || this.smogBubbles[x].rx > 150 + this.addlimit) {\n            this.smogBubbles[x].rxVelocity *= -1;\n          }\n\n          if (this.smogBubbles[x].ry < 70 + this.addlimit || this.smogBubbles[x].ry > 150 + this.addlimit) {\n            this.smogBubbles[x].ryVelocity *= -1;\n          }\n\n          this.smogBubbles[x].xOffset += this.smogBubbles[x].xVelocity;\n          this.smogBubbles[x].yOffset += this.smogBubbles[x].yVelocity;\n          this.smogBubbles[x].rx += this.smogBubbles[x].rxVelocity;\n          this.smogBubbles[x].ry += this.smogBubbles[x].ryVelocity;\n          this.smogBubbles[x].move();\n        }\n      }\n\n      if (this.x > p.width + 50) {\n        this.x = -50;\n      } else if (this.x < -50) {\n        this.x = p.width - 100;\n      }\n\n      this.x += this.xVelocity;\n    };\n  }\n\n}\n\nclass SmogBubble {\n  constructor(p, xlimit, ylimit, wMod, hMod) {\n    this.opacity = p.random(50, 200);\n    this.xVelocity = p.random(0.03, 0.07);\n    this.yVelocity = p.random(0.03, 0.07);\n    this.xOffset = p.random(xlimit / 2 * -1, xlimit / 2);\n    this.yOffset = p.random(ylimit / 2 * -1, ylimit / 2);\n    this.rx = p.random(70 + wMod, 150 + wMod);\n    this.ry = p.random(70 + hMod, 150 + hMod);\n    this.rxVelocity = p.random(0.1, 0.5);\n    this.ryVelocity = p.random(0.1, 0.5);\n    this.size = this.rx;\n    this.x = 0;\n    this.y = 0;\n\n    this.display = function (x, y) {\n      this.x = x + this.xOffset;\n      this.y = y + this.yOffset;\n      p.ellipse(x + this.xOffset, y + this.yOffset, this.rx, this.ry);\n      p.curveVertex(x + this.xOffset, y + this.yOffset);\n    };\n\n    this.move = function () {\n      // check if mouse is pressed and within range of bubble\n      //console.log(this.size);\n      if (p.mouseIsPressed && p.dist(p.mouseX, p.mouseY, this.x, this.y) < this.size) {\n        hoveredSmogData.mouseOver = true;\n        hoveredSmog = this;\n      }\n    };\n  }\n\n}\n\nexport function setupSmogClouds(p, nitrousData, currentDate) {\n  if (nitrousData == undefined) {\n    for (let i = 0; i < initial_clouds; i++) {\n      smogClouds[i] = new SmogCloud(p, null, null);\n    }\n  } else {\n    let currIndex = 33 + (currentDate.getFullYear() - 2004) * 12 + currentDate.getMonth();\n\n    for (let i = 0; i < nitrousData[0].average / 10; i++) {\n      smogClouds[i] = new SmogCloud(p, nitrousData[currIndex], nitrousData[0]);\n    }\n  }\n}\nexport function drawSmogClouds(p, nitrousData, currentDate) {\n  let currIndex = 33 + (currentDate.getFullYear() - 2004) * 12 + currentDate.getMonth();\n\n  if (originalData == null && nitrousData != null) {\n    originalData = nitrousData[0];\n  } else if (nitrousData != undefined && currIndex > 0 && currIndex < nitrousData.length) {\n    let diff = Math.round((nitrousData[currIndex].average - originalData.average) / 10) - extra_clouds; //console.log(diff);\n\n    if (diff > 0) {\n      for (let x = 0; x < diff; x++) {\n        smogClouds[smogClouds.length] = new SmogCloud(p, nitrousData[currIndex], originalData);\n        extra_clouds++;\n        console.log(\"Extra cloud created\");\n      }\n    } else if (diff < 0 && extra_clouds > 0) {\n      console.log(\"Diff: \" + diff);\n      let slice = smogClouds.length + diff;\n      extra_clouds -= smogClouds.length - slice;\n      console.log(\"Extra clouds: \" + extra_clouds);\n      console.log(\"Length \" + smogClouds.length);\n      console.log(\"Slice \" + slice);\n      smogClouds = smogClouds.slice(0, slice);\n    }\n  }\n\n  if (currIndex >= 0) {\n    if (currIndex < nitrousData.length) {\n      //console.log(nitrousData[currIndex]);\n      hoveredSmogData.value = nitrousData[currIndex].average;\n    } else {\n      hoveredSmogData.value = nitrousData[nitrousData.length - 1].average;\n    }\n\n    for (var i = 0; i < smogClouds.length; i++) {\n      if (!hoveredSmogData.mouseOver) {\n        smogClouds[i].move(p);\n      } else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\n        hoveredSmogData.mouseOver = false;\n      }\n\n      smogClouds[i].display(nitrousData[currIndex]);\n    }\n  } else {\n    hoveredSmogData.value = nitrousData[0].average;\n\n    for (var i = 0; i < smogClouds.length; i++) {\n      if (!hoveredSmogData.mouseOver) {\n        smogClouds[i].move(p);\n      } else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\n        hoveredSmogData.mouseOver = false;\n      }\n\n      smogClouds[i].display(nitrousData[0]);\n    }\n  }\n} //nitrousData[;","map":{"version":3,"sources":["C:/Users/kuent/Documents/FinishDipshit/Creative/Ocean-Weather-Visualization/src/sketches/smogClouds.js"],"names":["smogClouds","originalData","initial_clouds","extra_clouds","hoveredSmogData","mouseOver","value","hoveredSmog","SmogCloud","constructor","p","todayData","initial","diff","undefined","oldData","Math","round","average","xVelocity","random","x","width","y","height","smogBubbles","opacity","addlimit","SmogBubble","display","noStroke","cloudColor","color","setAlpha","fill","parseFloat","ellipse","beginShape","length","rx","ry","endShape","CLOSE","move","abs","xOffset","addLimit","yOffset","yVelocity","rxVelocity","ryVelocity","xlimit","ylimit","wMod","hMod","size","curveVertex","mouseIsPressed","dist","mouseX","mouseY","setupSmogClouds","nitrousData","currentDate","i","currIndex","getFullYear","getMonth","drawSmogClouds","console","log","slice"],"mappings":"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","sourcesContent":["let smogClouds = [];\r\nlet originalData = null;\r\nconst initial_clouds = 4;\r\nlet extra_clouds = 0;\r\n\r\nexport let hoveredSmogData = { mouseOver: false, value: null };\r\nlet hoveredSmog = null;\r\n\r\nclass SmogCloud {\r\n    constructor(p, todayData, initial) {\r\n        let diff = 0;\r\n        if(todayData == undefined || initial == undefined) {\r\n            this.todayData = undefined;\r\n            this.oldData = undefined\r\n        }\r\n        else {\r\n            this.todayData = todayData;\r\n            this.oldData = initial;\r\n            diff = Math.round(((todayData.average - initial.average)*10))\r\n        }\r\n\r\n        \r\n\r\n        this.xVelocity = p.random(-2, 2); //cloud movement velocity\r\n        this.x = p.random(50, p.width);\r\n        this.y = p.random(50, 200);\r\n        this.width = p.random(100 + diff, 300 + diff);\r\n        this.height = p.random(50 + diff, 100 + diff);\r\n        this.smogBubbles = [];\r\n        this.opacity = p.random(50, 200);\r\n        this.addlimit = 0;\r\n\r\n        for (let x = 0; x < 25; x++) {\r\n            this.smogBubbles[x] = new SmogBubble(p, this.width, this.height, diff, diff);\r\n        }\r\n\r\n        this.display = function (todayData) {\r\n            this.oldData = this.todayData\r\n            this.todayData = todayData;\r\n            if(this.todayData == undefined) {\r\n                this.todayData = this.oldData;\r\n            }\r\n            // console.log(\"Displaying smog cloud\");\r\n\r\n            if(this.oldData != undefined) {\r\n                p.noStroke();\r\n                let cloudColor = p.color(100);\r\n                cloudColor.setAlpha(this.opacity);\r\n                p.fill(cloudColor);\r\n\r\n                this.width += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10\r\n                this.height += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10\r\n                if (hoveredSmogData.mouseOver) {\r\n                    p.fill(225, 225, 0, 70)\r\n                }\r\n                p.ellipse(this.x, this.y, this.width, this.height);\r\n                p.beginShape();\r\n                for (let x = 0; x < this.smogBubbles.length; x++) {\r\n                    cloudColor.setAlpha(this.smogBubbles[x].opacity);\r\n                    p.fill(cloudColor);\r\n                    this.smogBubbles[x].rx += (this.todayData.average - this.oldData.average)* 10\r\n                    this.smogBubbles[x].ry += (this.todayData.average - this.oldData.average)* 10\r\n\r\n                    //this.smogBubbles[x].rxVelocity += (this.todayData.average - this.oldData.average)\r\n                    //this.smogBubbles[x].ryVelocity += (this.todayData.average - this.oldData.average)\r\n                    if (hoveredSmogData.mouseOver) {\r\n                        p.fill(225, 225, 0, 70)\r\n                    }\r\n                    this.smogBubbles[x].display(this.x,this.y)\r\n                }\r\n            }\r\n            p.endShape(p.CLOSE);\r\n        };\r\n\r\n        this.move = function () {\r\n            if(this.oldData != undefined) {\r\n                this.addlimit += (parseFloat(this.todayData.average) - parseFloat(this.oldData.average))* 10;\r\n                for (let x = 0; x < this.smogBubbles.length; x++) {\r\n                    if (Math.abs(this.smogBubbles[x].xOffset) > this.width / 2 - 10 + this.addLimit) {\r\n                        this.smogBubbles[x].xVelocity *= -1;\r\n                    }\r\n                    if (Math.abs(this.smogBubbles[x].yOffset) > this.height / 2 - 10 + this.addLimit) {\r\n                        this.smogBubbles[x].yVelocity *= -1;\r\n                    }\r\n                    if (this.smogBubbles[x].rx < 70 + this.addlimit || this.smogBubbles[x].rx > 150 + this.addlimit) {\r\n                        this.smogBubbles[x].rxVelocity *= -1;\r\n                    }\r\n                    if (this.smogBubbles[x].ry < 70 + this.addlimit || this.smogBubbles[x].ry > 150 + this.addlimit) {\r\n                        this.smogBubbles[x].ryVelocity *= -1;\r\n                    }\r\n\r\n                    this.smogBubbles[x].xOffset += this.smogBubbles[x].xVelocity;\r\n                    this.smogBubbles[x].yOffset += this.smogBubbles[x].yVelocity;\r\n\r\n                    this.smogBubbles[x].rx += this.smogBubbles[x].rxVelocity;\r\n                    this.smogBubbles[x].ry += this.smogBubbles[x].ryVelocity;\r\n\r\n                    this.smogBubbles[x].move()\r\n                }\r\n            }\r\n            if (this.x > p.width + 50) {\r\n                this.x = -50;\r\n            } else if (this.x < -50) {\r\n                this.x = p.width - 100;\r\n            }\r\n            this.x += this.xVelocity;\r\n        };\r\n    }\r\n}\r\n\r\nclass SmogBubble {\r\n    constructor(p, xlimit, ylimit, wMod, hMod) {\r\n        this.opacity = p.random(50, 200);\r\n        this.xVelocity = p.random(0.03, 0.07);\r\n        this.yVelocity = p.random(0.03, 0.07);\r\n        this.xOffset = p.random((xlimit / 2) * -1, xlimit / 2);\r\n        this.yOffset = p.random((ylimit / 2) * -1, ylimit / 2);\r\n        this.rx = p.random(70 + wMod, 150 + wMod);\r\n        this.ry = p.random(70+ hMod, 150 + hMod);\r\n\r\n        this.rxVelocity = p.random(0.1, 0.5);\r\n        this.ryVelocity = p.random(0.1, 0.5);\r\n\r\n        this.size = this.rx\r\n        this.x = 0\r\n        this.y = 0\r\n\r\n    this.display = function (x,y) {\r\n      this.x = x + this.xOffset\r\n      this.y = y + this.yOffset\r\n      p.ellipse(\r\n          x + this.xOffset,\r\n          y + this.yOffset,\r\n          this.rx,\r\n          this.ry\r\n      );\r\n      p.curveVertex(\r\n          x + this.xOffset,\r\n          y + this.yOffset\r\n      );\r\n    }\r\n    this.move = function(){// check if mouse is pressed and within range of bubble\r\n      //console.log(this.size);\r\n      if (p.mouseIsPressed && p.dist(p.mouseX, p.mouseY, this.x, this.y) < this.size) {\r\n          hoveredSmogData.mouseOver = true;\r\n          hoveredSmog = this;\r\n\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function setupSmogClouds(p, nitrousData, currentDate) {\r\n    if(nitrousData == undefined) {\r\n        for (let i = 0; i < initial_clouds; i++) {\r\n            smogClouds[i] = new SmogCloud(p, null, null);\r\n        }\r\n    }\r\n    else {\r\n        let currIndex = 33 + ((currentDate.getFullYear() - 2004) * 12) + currentDate.getMonth()\r\n        for(let i = 0; i < nitrousData[0].average / 10; i++) {\r\n            smogClouds[i] = new SmogCloud(p, nitrousData[currIndex], nitrousData[0]);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport function drawSmogClouds(p, nitrousData, currentDate) {\r\n        let currIndex = 33 + ((currentDate.getFullYear() - 2004) * 12) + currentDate.getMonth()\r\n\r\n        if(originalData == null && nitrousData != null) {\r\n            originalData = nitrousData[0];\r\n\r\n        }\r\n\r\n        else if(nitrousData != undefined && currIndex > 0 && currIndex < nitrousData.length) {\r\n            let diff = Math.round(((nitrousData[currIndex].average - originalData.average)/10)) - extra_clouds;\r\n            //console.log(diff);\r\n\r\n            if(diff > 0) {\r\n                for(let x = 0 ; x < diff; x++) {\r\n                    smogClouds[smogClouds.length] = new SmogCloud(p, nitrousData[currIndex], originalData);\r\n                    extra_clouds++;\r\n                    console.log(\"Extra cloud created\");\r\n                }\r\n            }\r\n            else if(diff < 0 && extra_clouds > 0) {\r\n                console.log(\"Diff: \"+diff);\r\n                let slice = smogClouds.length + diff;\r\n                extra_clouds -= (smogClouds.length - slice);\r\n                console.log(\"Extra clouds: \"+ extra_clouds);\r\n                console.log(\"Length \"+ smogClouds.length);\r\n                console.log(\"Slice \" + slice)\r\n                smogClouds = smogClouds.slice(0, slice);\r\n            }\r\n        }\r\n\r\n        if(currIndex >= 0 ) {\r\n          if (currIndex < nitrousData.length){\r\n            //console.log(nitrousData[currIndex]);\r\n            hoveredSmogData.value = nitrousData[currIndex].average\r\n          }\r\n          else {\r\n            hoveredSmogData.value = nitrousData[nitrousData.length-1].average\r\n          }\r\n\r\n            for (var i = 0; i < smogClouds.length; i++) {\r\n              if (!hoveredSmogData.mouseOver) {\r\n\r\n                smogClouds[i].move(p);\r\n              }\r\n              else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\r\n                  hoveredSmogData.mouseOver = false;\r\n              }\r\n\r\n                smogClouds[i].display(nitrousData[currIndex]);\r\n            }\r\n        }\r\n        else {\r\n            hoveredSmogData.value = nitrousData[0].average\r\n\r\n            for(var i = 0; i < smogClouds.length; i++) {\r\n              if (!hoveredSmogData.mouseOver) {\r\n\r\n                smogClouds[i].move(p);\r\n              }\r\n              else if (p.dist(p.mouseX, p.mouseY, hoveredSmog.x, hoveredSmog.y) > hoveredSmog.size) {\r\n                  hoveredSmogData.mouseOver = false;\r\n              }\r\n\r\n                smogClouds[i].display(nitrousData[0]);\r\n            }\r\n        }\r\n\r\n\r\n}\r\n\r\n//nitrousData[;\r\n"]},"metadata":{},"sourceType":"module"}